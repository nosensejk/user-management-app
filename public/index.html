<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Register</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  </head>

  <body class="bg-light">
    <div class="container" style="max-width: 500px; margin-top: 50px">
      <h3 class="mb-3 text-center">User Management</h3>
      <div id="statusMessage"></div>

      <form id="registerForm">
        <h5>Register</h5>
        <div class="mb-3">
          <label for="name" class="form-label">Name</label>
          <input
            type="text"
            class="form-control"
            id="name"
            name="name"
            placeholder="Enter your name"
            required
          />
        </div>
        <div class="mb-3">
          <label for="email" class="form-label">Email</label>
          <input
            type="email"
            class="form-control"
            id="email"
            name="email"
            placeholder="Enter your email"
            required
          />
        </div>
        <div class="mb-3">
          <label for="password" class="form-label">Password</label>
          <input
            type="password"
            class="form-control"
            id="password"
            name="password"
            placeholder="Enter your password"
            required
          />
        </div>
        <button type="submit" class="btn btn-success w-100">Register</button>
      </form>
      <p><a href="/login.html">Login</a></p>
    </div>

    <script>
      $(document).ready(function () {
        function showMessage(msg, success = true) {
          $("#statusMessage").html(
            `<div class="alert alert-${success ? "success" : "danger"}">${msg}</div>`,
          );
        }

        window.getUniqIdValue = function (prefix = "id") {
          return prefix + "_" + Math.random().toString(36).substr(2, 9);
        };

        $("#registerForm").submit(async function (e) {
          e.preventDefault();
          const data = {
            name: this.name.value,
            email: this.email.value,
            password: this.password.value,
          };
          const resp = await $.post("/register", data);
          if (resp.success) {
            showMessage(resp.message);
            this.reset();
          } else showMessage(resp.message, false);
        });
      });
    </script>
  </body>
</html>
